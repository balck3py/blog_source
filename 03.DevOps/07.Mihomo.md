---
title: Ubuntu Server å‘½ä»¤è¡Œä¸Šç½‘éƒ¨ç½²æŒ‡å— (Mihomo æ–¹æ¡ˆ)
date: 2025-12-17
author: Eugen
tags:
  - Mihomo
  - Clash Meta
  - Ubuntu Server
  - ä»£ç†
  - å‘½ä»¤è¡Œ
  - Systemd
  - Web Dashboard
  - ç½‘ç»œä»£ç†
  - DevOps
  - æœåŠ¡å™¨é…ç½®
---

# ğŸš€ Ubuntu Server å‘½ä»¤è¡Œä¸Šç½‘éƒ¨ç½²æŒ‡å— (Mihomo æ–¹æ¡ˆ)

> äº‹å…ˆå£°æ˜ï¼Œä¸‹é¢çš„å†…å®¹ä»…è®°å½•å®‰è£…mihomoä»¥åŠé…ç½®çš„è¸©å‘å’Œå­¦ä¹ è¿‡ç¨‹ï¼Œç”¨äºè®¿é—®è‡ªå·±åœ¨æµ·å¤–çš„å¼€å‘æœåŠ¡å™¨ï¼Œè¯·å‹¿ç”¨äºåšä»»ä½•è¿è§„è¿æ³•äº‹æƒ…ï¼Œå‘ç”Ÿä»»ä½•åæœå’Œæœ¬äººä»¥åŠæœ¬æ–‡æ— å…³

**é€‚ç”¨ç¯å¢ƒ**ï¼šUbuntu Server (æ— å›¾å½¢ç•Œé¢) / Debian
**æ ¸å¿ƒç»„ä»¶**ï¼šMihomo (åŸ Clash Meta)
**ç®¡ç†æ–¹å¼**ï¼šæœ¬åœ°æµè§ˆå™¨ Web Dashboard + å‘½ä»¤è¡Œç¯å¢ƒå˜é‡

---

## ğŸ“¦ ç¬¬ä¸€æ­¥ï¼šå®‰è£…æ ¸å¿ƒä¸å¿…è¦ä¾èµ–

æˆ‘ä»¬éœ€è¦ä¸‹è½½ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶ä»¥åŠç”¨äºåˆ†æµçš„ Geo æ•°æ®åº“ã€‚

1.  **ä¸‹è½½å¹¶å®‰è£… Mihomo æ ¸å¿ƒ**
    *æœ€æ–°ç‰ˆæœ¬å¯ä»¥æŸ¥çœ‹(Github Release)[https://github.com/MetaCubeX/mihomo/releases/] *
    ```bash
    # è¿›å…¥ä¸´æ—¶ç›®å½•
    cd /tmp

    # ä¸‹è½½æ ¸å¿ƒ (amd64æ¶æ„)
    wget https://github.com/MetaCubeX/mihomo/releases/download/v1.18.1/mihomo-linux-amd64-v1.18.1.gz

    # è§£å‹
    gzip -d mihomo-linux-amd64-v1.18.1.gz

    # ç§»åŠ¨åˆ°ç³»ç»Ÿè·¯å¾„å¹¶é‡å‘½å
    sudo mv mihomo-linux-amd64-v1.18.1 /usr/local/bin/mihomo

    # èµ‹äºˆæ‰§è¡Œæƒé™
    sudo chmod +x /usr/local/bin/mihomo

    # éªŒè¯å®‰è£…
    mihomo -v
    ```

2.  **å‡†å¤‡é…ç½®ç›®å½•ä¸ Geo æ•°æ®åº“**
    *(è¿™äº›æ–‡ä»¶ç”¨äºè¯†åˆ«æµé‡æ˜¯å›½å†…è¿˜æ˜¯å›½å¤–ï¼Œå®ç°è‡ªåŠ¨åˆ†æµ)*
    ```bash
    # åˆ›å»ºç›®å½•
    sudo mkdir -p /etc/mihomo

    # ä¸‹è½½è§„åˆ™åº“ (GeoIP / GeoSite / MMDB)
    sudo wget -O /etc/mihomo/Country.mmdb https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/country.mmdb
    sudo wget -O /etc/mihomo/geosite.dat https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat
    sudo wget -O /etc/mihomo/geoip.dat https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip.dat
    ```

---

## âš™ï¸ ç¬¬äºŒæ­¥ï¼šé…ç½®è®¢é˜…ä¸å¤–éƒ¨æ§åˆ¶

**é‡è¦æç¤º**ï¼šå¦‚æœä½ çš„è®¢é˜…é“¾æ¥æ˜¯ Base64 (ä¹±ç )ï¼Œè¯·å…ˆä½¿ç”¨â€œè®¢é˜…è½¬æ¢â€å°†å…¶è½¬æ¢ä¸º **Clash (YAML)** æ ¼å¼ã€‚å»ºè®®é€‰æ‹©å« `ACL4SSR` è§„åˆ™çš„è½¬æ¢æ¨¡æ¿ï¼Œä»¥ç¡®ä¿å›½å†…æµé‡ç›´è¿ã€‚

1.  **ä¸‹è½½è®¢é˜…æ–‡ä»¶**
    ```bash
    # è¯·å°† URL æ›¿æ¢ä¸ºä½ è‡ªå·±çš„ Clash è®¢é˜…é“¾æ¥
    sudo wget -O /etc/mihomo/config.yaml "https://ä½ çš„è®¢é˜…é“¾æ¥..."
    ```

2.  **ä¿®æ”¹é…ç½®æ–‡ä»¶ (å…³é”®æ­¥éª¤)**
    æˆ‘ä»¬éœ€è¦å…è®¸å¤–éƒ¨ Web é¢æ¿è¿æ¥ï¼Œå¹¶è®¾ç½®è®¿é—®å¯†ç ã€‚
    ```bash
    sudo nano /etc/mihomo/config.yaml
    ```
    è¯·**ä¿®æ”¹**æˆ–**æ·»åŠ **ä»¥ä¸‹å­—æ®µåˆ°æ–‡ä»¶é¡¶éƒ¨ï¼ˆè¦†ç›–åŸæœ‰è®¾ç½®ï¼‰ï¼š

    ```yaml
    # å…è®¸å±€åŸŸç½‘è¿æ¥ (å»ºè®®å¼€å¯)
    allow-lan: true
    
    # ç»‘å®šåœ°å€ (è®¾ä¸º * æˆ– 0.0.0.0 ä»¥å…è®¸å¤–éƒ¨æ§åˆ¶ï¼Œå¦‚æœåªéœ€è¦ç»™æœåŠ¡å™¨åŠ é€Ÿä½¿ç”¨ï¼Œå¯ä»¥ä¸é…ç½®bind-address)
    bind-address: '*'
    
    # è¿è¡Œæ¨¡å¼ (å¿…é¡»æ˜¯ rule æ‰èƒ½è‡ªåŠ¨åˆ†æµ)
    mode: rule
    
    # å¤–éƒ¨æ§åˆ¶å™¨ç›‘å¬åœ°å€ (Web Dashboard ç”¨)
    external-controller: '0.0.0.0:9090'
    
    # å¤–éƒ¨æ§åˆ¶å¯†é’¥ (Web é¢æ¿ç™»å½•å¯†ç ï¼Œè¯·è®¾ç½®å¾—å¤æ‚ä¸€ç‚¹)
    secret: 'ä½ çš„å¼ºå¯†ç '
    ```
    *(æ“ä½œæç¤ºï¼šCtrl+O ä¿å­˜ï¼ŒEnter ç¡®è®¤ï¼ŒCtrl+X é€€å‡º)*

---

## ğŸ›¡ï¸ ç¬¬ä¸‰æ­¥ï¼šè®¾ç½®å¼€æœºè‡ªå¯ (Systemd)

å°† Mihomo è®¾ç½®ä¸ºåå°æœåŠ¡ï¼Œç¡®ä¿æœåŠ¡å™¨é‡å¯åè‡ªåŠ¨è¿è¡Œã€‚

1.  **åˆ›å»ºæœåŠ¡æ–‡ä»¶**
    ```bash
    sudo nano /etc/systemd/system/mihomo.service
    ```

2.  **ç²˜è´´ä»¥ä¸‹å†…å®¹**
    ```ini
    [Unit]
    Description=Mihomo Daemon
    After=network.target

    [Service]
    Type=simple
    ExecStart=/usr/local/bin/mihomo -d /etc/mihomo
    Restart=always

    [Install]
    WantedBy=multi-user.target
    ```

3.  **å¯åŠ¨æœåŠ¡**
    ```bash
    sudo systemctl daemon-reload
    sudo systemctl enable mihomo
    sudo systemctl start mihomo
    sudo systemctl status mihomo
    # çœ‹åˆ°ç»¿è‰²çš„ active (running) å³è¡¨ç¤ºæˆåŠŸ
    ```

---

## ğŸ–¥ï¸ ç¬¬å››æ­¥ï¼šé…ç½® Web Dashboard (æ§åˆ¶å°)

åœ¨ä½ çš„ Windows/Mac ç”µè„‘æµè§ˆå™¨ä¸Šç®¡ç†æœåŠ¡å™¨çš„ä»£ç†èŠ‚ç‚¹ã€‚

1.  **æ”¾è¡Œé˜²ç«å¢™ç«¯å£**
    *   å¦‚æœä½ æœ‰äº‘æœåŠ¡å•†ï¼ˆé˜¿é‡Œäº‘/AWSç­‰ï¼‰ï¼Œè¯·å»ç½‘é¡µæ§åˆ¶å°çš„ **å®‰å…¨ç»„ (Security Group)** æ”¾è¡Œ TCP ç«¯å£ **9090**ã€‚
    *   æœåŠ¡å™¨å†…éƒ¨é˜²ç«å¢™ï¼š
        ```bash
        sudo ufw allow 9090
        ```

2.  **è®¿é—® Dashboard**
    ç”±äºæµè§ˆå™¨å®‰å…¨ç­–ç•¥ï¼ˆMixed Contentï¼‰ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨ **HTTP** åè®®çš„é¢æ¿åœ°å€ï¼Œå¦åˆ™å¯èƒ½æ— æ³•è¿æ¥ã€‚

    *   **æ¨èé¢æ¿ (Yacd)**: [http://yacd.haishan.me/](http://yacd.haishan.me/)
    *   **æˆ–è€… Metacubexd**: [http://metacubex.github.io/metacubexd/](http://metacubex.github.io/metacubexd/) (éœ€æµè§ˆå™¨å…è®¸ä¸å®‰å…¨å†…å®¹)

3.  **è¿æ¥è®¾ç½®**
    *   **API Base URL**: `http://ä½ çš„æœåŠ¡å™¨å…¬ç½‘IP:9090`
    *   **Secret**: ä½ åœ¨é…ç½®æ–‡ä»¶é‡Œå¡«çš„å¯†ç ã€‚
    *   **è¿æ¥å**ï¼šåœ¨ "Proxies" é¡µé¢é€‰æ‹©èŠ‚ç‚¹ï¼Œåœ¨ "Config" é¡µé¢ç¡®è®¤ Mode ä¸º **Rule**ã€‚

---

## ğŸ’» ç¬¬äº”æ­¥ï¼šè®¾ç½®å‘½ä»¤è¡Œä»£ç† (å¦‚ä½•ä½¿ç”¨)

æœåŠ¡å™¨æœ¬èº«ä¸ä¼šè‡ªåŠ¨èµ°ä»£ç†ï¼Œä½ éœ€è¦é…ç½®ç¯å¢ƒå˜é‡ã€‚

### 1. è®¾ç½®å¿«æ·åˆ«å (æ¨è)
ç¼–è¾‘ä½ çš„ Shell é…ç½®æ–‡ä»¶ï¼š
```bash
nano ~/.bashrc
```
åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ï¼š
```bash
# ä»£ç†åœ°å€ (å‡è®¾æ··åˆç«¯å£ä¸º 7890)
proxy_server="http://127.0.0.1:7890"

alias proxy="export http_proxy=$proxy_server; \
             export https_proxy=$proxy_server; \
             export ftp_proxy=$proxy_server; \
             export HTTP_PROXY=$proxy_server; \
             export HTTPS_PROXY=$proxy_server; \
             export FTP_PROXY=$proxy_server; \
             export no_proxy=localhost,127.0.0.1,::1; \
             echo 'Proxy ON ğŸš€'"

alias unproxy="unset http_proxy https_proxy ftp_proxy HTTP_PROXY HTTPS_PROXY FTP_PROXY; \
               echo 'Proxy OFF ğŸ›‘'"
```
ä¿å­˜ååº”ç”¨ï¼š
```bash
source ~/.bashrc
```

### 2. æ—¥å¸¸ä½¿ç”¨
*   **å¼€å¯ä»£ç†**ï¼šè¾“å…¥ `proxy`
*   **å…³é—­ä»£ç†**ï¼šè¾“å…¥ `unproxy`

### 3. âš ï¸ å¸¸è§é¿å‘æŒ‡å— (Sudo ä¸ Git)
*   **Sudo å‘½ä»¤**ï¼šé»˜è®¤ `sudo` ä¼šé‡ç½®ç¯å¢ƒå˜é‡ï¼Œå¯¼è‡´ä»£ç†å¤±æ•ˆã€‚
    *   âŒ é”™è¯¯ï¼š`sudo wget ...`
    *   âœ… æ­£ç¡®ï¼š`sudo -E wget ...` (åŠ  -E ä¿ç•™ç¯å¢ƒå˜é‡)
*   **Git ä¸‹è½½**ï¼š
    *   è¯·ä½¿ç”¨ HTTPS é“¾æ¥ (`git clone https://...`)ï¼Œä¸è¦ä½¿ç”¨ SSH é“¾æ¥ (`git@...`)ï¼Œå› ä¸º SSH åè®®ä¸èµ° HTTP ä»£ç†ã€‚

---

## ğŸ” ç¬¬å…­æ­¥ï¼šéªŒè¯ä¸æµ‹è¯•

1.  **å¼€å¯ä»£ç†**ï¼š
    ```bash
    proxy
    ```
2.  **æµ‹è¯•è¿é€šæ€§**ï¼š
    *(ä¸è¦ç”¨ pingï¼Œping ä¸èµ°ä»£ç†)*
    ```bash
    curl -v https://www.google.com
    ```
    *   å¦‚æœçœ‹åˆ° `Connected to 127.0.0.1 port 7890`ï¼Œè¯´æ˜ä»£ç†æˆåŠŸæ¥ç®¡ã€‚
    *   å¦‚æœçœ‹åˆ°ç›´æ¥è¿æ¥ Google çš„ IPï¼Œè¯´æ˜ç¯å¢ƒå˜é‡æœªç”Ÿæ•ˆã€‚

3.  **æµ‹è¯•åˆ†æµ (æ˜¯å¦çœæµé‡)**ï¼š
    ```bash
    curl -v https://www.baidu.com
    ```
    *   è™½ç„¶å¼€å¯äº† `proxy`ï¼Œä½†å› ä¸ºæœ‰ Geo è§„åˆ™ï¼ŒMihomo åº”è¯¥ä¼šè¯†åˆ«ä¸º CN å¹¶ç›´è¿ï¼ˆDashboard æ—¥å¿—ä¸­ä¼šæ˜¾ç¤º Rule åŒ¹é…ä¸º DIRECTï¼‰ã€‚

---

## ğŸ”„ ç»´æŠ¤ä¸æ›´æ–°

å¦‚æœä½ çš„æœºåœºè®¢é˜…é“¾æ¥å˜äº†ï¼Œæˆ–è€…æƒ³æ›´æ–°èŠ‚ç‚¹ï¼š

```bash
# 1. é‡æ–°ä¸‹è½½é…ç½®
sudo wget -O /etc/mihomo/config.yaml "ä½ çš„æ–°è®¢é˜…é“¾æ¥"

# 2. é‡æ–°ä¿®æ”¹å¿…è¦å‚æ•° (allow-lan, secret, external-controller)
# (å»ºè®®å‡†å¤‡ä¸€ä¸ª sed è„šæœ¬è‡ªåŠ¨æ›¿æ¢ï¼Œæˆ–è€…æ‰‹åŠ¨ nano ä¿®æ”¹)

# 3. é‡å¯æœåŠ¡
sudo systemctl restart mihomo
```